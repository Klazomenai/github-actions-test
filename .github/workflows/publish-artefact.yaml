name: "Integration Tests and Publish on Tag"

on:
  push:
    tags:
    - 'foo-v[0-9]+.[0-9]+.[0-9]+*'
    - 'baz-v[0-9]+.[0-9]+.[0-9]+*'

jobs:
  integration_tests_publish_on_tag:
    runs-on: ubuntu-latest

    steps:
    - name: Echo
      run: |
        echo ${GITHUB_REF##*/}
        echo '::set-env name=CHART_NAME::'$(echo ${GITHUB_REF##*/} | sed -E s/-[0-9]+\.[0-9]+\.[0-9]+$//g)
        echo '::set-env name=RELEASE::'$(echo ${GITHUB_REF##*/} | sed -Eo s/-[0-9]+\.[0-9]+\.[0-9]+$//g)

